upstream backend_round_robin {
    # Round Robin: 轮流分配到每台服务器（默认算法）
    # 注释掉 ip_hash，使用默认的轮询

    server host.docker.internal:8081;
    server host.docker.internal:8082;
    server host.docker.internal:8083;
}

server {
    listen 80;
    server_name localhost;

    location / {
        proxy_pass http://backend_round_robin;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        # 添加响应头，方便调试
        add_header X-Backend-Server $upstream_addr;
    }
}
