# ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹(DDIA) é˜…è¯»ç¬”è®°

> Designing Data-Intensive Applications by Martin Kleppmann
>
> è¿™æ˜¯ç³»ç»Ÿè®¾è®¡é¢†åŸŸçš„åœ£ç»çº§è‘—ä½œ,æ·±å…¥æµ…å‡ºåœ°è®²è§£äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µ

---

## ğŸ“š å…¨ä¹¦ç»“æ„æ¦‚è§ˆ

### Part I: æ•°æ®ç³»ç»ŸåŸºç¡€ (Foundations of Data Systems)

- **Chapter 1**: å¯é ã€å¯æ‰©å±•ã€å¯ç»´æŠ¤çš„åº”ç”¨ç³»ç»Ÿ
- **Chapter 2**: æ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€
- **Chapter 3**: å­˜å‚¨ä¸æ£€ç´¢
- **Chapter 4**: ç¼–ç ä¸æ¼”åŒ–

### Part II: åˆ†å¸ƒå¼æ•°æ® (Distributed Data)

- **Chapter 5**: å¤åˆ¶
- **Chapter 6**: åˆ†åŒº
- **Chapter 7**: äº‹åŠ¡
- **Chapter 8**: åˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦
- **Chapter 9**: ä¸€è‡´æ€§ä¸å…±è¯†

### Part III: æ´¾ç”Ÿæ•°æ® (Derived Data)

- **Chapter 10**: æ‰¹å¤„ç†
- **Chapter 11**: æµå¤„ç†
- **Chapter 12**: æ•°æ®ç³»ç»Ÿçš„æœªæ¥

---

## ç¬¬ä¸€éƒ¨åˆ†: æ•°æ®ç³»ç»ŸåŸºç¡€

### Chapter 1: å¯é ã€å¯æ‰©å±•ã€å¯ç»´æŠ¤çš„åº”ç”¨ç³»ç»Ÿ

**é˜…è¯»çŠ¶æ€**: âœ… å·²å®Œæˆ | **æ—¥æœŸ**: 2025-10-16

#### æ ¸å¿ƒæ¦‚å¿µ

**ä¸‰å¤§è´¨é‡å±æ€§**:

1. **å¯é æ€§ (Reliability)**
   - æ•…éšœç±»å‹: ç¡¬ä»¶æ•…éšœã€è½¯ä»¶é”™è¯¯ã€äººä¸ºé”™è¯¯
   - å®¹é”™è®¾è®¡åŸåˆ™
   - å…³é”®è¯: Fault vs Failure, Fault-Tolerant

2. **å¯æ‰©å±•æ€§ (Scalability)**
   - è´Ÿè½½æè¿°: QPS, è¯»å†™æ¯”, Twitter æ‰‡å‡ºæ¡ˆä¾‹
   - æ€§èƒ½åº¦é‡: å“åº”æ—¶é—´, ååé‡, ç™¾åˆ†ä½æ•° (P50/P95/P99)
   - æ‰©å±•æ–¹å¼: å‚ç›´æ‰©å±• vs æ°´å¹³æ‰©å±•
   - å…³é”®æ´å¯Ÿ: æ²¡æœ‰é€šç”¨æ¶æ„,éœ€æ ¹æ®è´Ÿè½½ç‰¹å¾è®¾è®¡

3. **å¯ç»´æŠ¤æ€§ (Maintainability)**
   - å¯æ“ä½œæ€§ (Operability): è®©è¿ç»´è½»æ¾
   - ç®€å•æ€§ (Simplicity): é€šè¿‡æŠ½è±¡å‡å°‘å¤æ‚åº¦
   - å¯æ¼”åŒ–æ€§ (Evolvability): è®©ç³»ç»Ÿæ˜“äºæ”¹å˜

#### ç»å…¸æ¡ˆä¾‹åˆ†æ

**Twitter æ—¶é—´çº¿è®¾è®¡**:
- æ–¹æ¡ˆ1 (Pull): è¯»æ—¶æŸ¥è¯¢åˆå¹¶ â†’ è¯»å‹åŠ›å¤§
- æ–¹æ¡ˆ2 (Push): å†™æ—¶æ‰‡å‡º â†’ å¤§Vå†™å…¥æˆæœ¬é«˜
- æ··åˆæ–¹æ¡ˆ: æ™®é€šç”¨æˆ·æ‰‡å‡º + å¤§Vç‰¹æ®Šå¤„ç†

**å…³é”®æ•°å­—**:
- å‘æ¨æ–‡: 4.6k req/s (å¹³å‡), 12k req/s (å³°å€¼)
- ä¸»é¡µæ—¶é—´çº¿: 300k req/s
- ç“¶é¢ˆ: **æ‰‡å‡ºå¯¼è‡´çš„å†™æ”¾å¤§**

#### å…³é”®æ´å¯Ÿ

1. **P99 å»¶è¿Ÿæ¯”å¹³å‡å€¼é‡è¦**
   - Amazon: 100ms å»¶è¿Ÿ = 1% é”€å”®é¢æŸå¤±
   - æœ€æ…¢è¯·æ±‚å¾€å¾€æ¥è‡ªæœ€æœ‰ä»·å€¼å®¢æˆ·

2. **è®¾è®¡æƒè¡¡æ— å¤„ä¸åœ¨**
   - Twitter: ä¼˜åŒ–è¯» vs ä¼˜åŒ–å†™
   - æ²¡æœ‰é“¶å¼¹,æ ¹æ®è´Ÿè½½ç‰¹å¾é€‰æ‹©

3. **å¤æ‚æ€§æ˜¯å¯ç»´æŠ¤æ€§çš„å¤§æ•Œ**
   - æ„å¤–å¤æ‚æ€§ (å®ç°) vs æœ¬è´¨å¤æ‚æ€§ (é—®é¢˜)
   - é€šè¿‡æŠ½è±¡å‡å°‘å¤æ‚åº¦

#### å»¶ä¼¸é˜…è¯»

**å¿…è¯»æ–‡ç« **:
- [Scalability for Dummies - Part 1: Clones](https://www.lecloud.net/post/7295452622/scalability-for-dummies-part-1-clones)
- [Scalability for Dummies - Part 2: Database](https://www.lecloud.net/post/7994751381/scalability-for-dummies-part-2-database)
- [Scalability for Dummies - Part 3: Cache](https://www.lecloud.net/post/9246290032/scalability-for-dummies-part-3-cache)
- [Scalability for Dummies - Part 4: Asynchronism](https://www.lecloud.net/post/9699762917/scalability-for-dummies-part-4-asynchronism)

**è§†é¢‘èµ„æº**:
- [Horizontal vs Vertical Scaling](https://www.youtube.com/watch?v=xpDnVSmNFX0) (15åˆ†é’Ÿ)
- [Understanding Latency Percentiles](https://www.youtube.com/watch?v=lJ8ydIuPFeU) (15åˆ†é’Ÿ)

**æŠ€æœ¯åšå®¢**:
- [Twitter's Timeline Architecture](https://www.infoq.com/presentations/Twitter-Timeline-Scalability/)
- [Amazon: How 1 Second Could Cost $1.6B](https://www.fastcompany.com/1825005/how-one-second-could-cost-amazon-16-billion-sales)
- [Brendan Gregg's USE Method](https://www.brendangregg.com/usemethod.html)

**ç›¸å…³ä¹¦ç±**:
- ã€ŠSite Reliability Engineeringã€‹ - Google SRE å®è·µ
- ã€ŠThe Art of Scalabilityã€‹ - AKF æ‰©å±•ç«‹æ–¹ä½“

#### å®è·µç»ƒä¹ 

1. **å®¹é‡è§„åˆ’ç»ƒä¹ **:
   - å‡è®¾: 100ä¸‡ DAU, æ¯äºº 20 è¯·æ±‚/å¤©, å³°å€¼å› å­ 3x
   - è®¡ç®—: å³°å€¼ QPS = (1,000,000 Ã— 20 / 86,400) Ã— 3 â‰ˆ 694 QPS

2. **Little's Law åº”ç”¨**:
   - å…¬å¼: å¹¶å‘ç”¨æˆ·æ•° = QPS Ã— å¹³å‡å“åº”æ—¶é—´
   - ç¤ºä¾‹: QPS=1000, RT=100ms â†’ éœ€è¦ 100 å¹¶å‘

3. **ç™¾åˆ†ä½æ•°è®¡ç®—**:
   - ç»™å®šå»¶è¿Ÿæ•°æ® [1ms, 2ms, ..., 100ms]
   - æ‰‹å·¥è®¡ç®— P50, P95, P99

#### æˆ‘çš„æ€è€ƒ

**é—®é¢˜**:
- â“ å¦‚æœ Twitter å®Œå…¨é‡‡ç”¨æŸ¥è¯¢æ—¶åˆå¹¶ä¼šæ€æ ·?
- â“ ä¸ºä»€ä¹ˆäº‘æ—¶ä»£æ›´éœ€è¦è½¯ä»¶å®¹é”™?
- â“ å¦‚ä½•åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä¿æŒç®€å•æ€§?

**ç­”æ¡ˆè¦ç‚¹**:
- æŸ¥è¯¢æ—¶åˆå¹¶ä¼šå¯¼è‡´ä¸»é¡µæ—¶é—´çº¿æŸ¥è¯¢æˆä¸ºç“¶é¢ˆ(éœ€è¦ join å¤§é‡æ•°æ®)
- äº‘ç¯å¢ƒè™šæ‹Ÿæœºéšæ—¶å¯èƒ½æ¶ˆå¤±,æœºå™¨æ•°é‡å¢åŠ ,æ•…éšœæ¦‚ç‡ä¸Šå‡
- é€šè¿‡é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)ã€æ¸…æ™°çš„æœåŠ¡è¾¹ç•Œã€æ ‡å‡†åŒ–æ¥å£å‡å°‘å¤æ‚åº¦

---

### Chapter 2: æ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. å…³ç³»æ¨¡å‹ vs æ–‡æ¡£æ¨¡å‹ vs å›¾æ¨¡å‹
2. SQL vs NoSQL çš„æƒè¡¡
3. å£°æ˜å¼æŸ¥è¯¢ vs å‘½ä»¤å¼æŸ¥è¯¢
4. MapReduce æŸ¥è¯¢

**å…³é”®æ¦‚å¿µ**:
- Schema-on-read vs Schema-on-write
- æ•°æ®å±€éƒ¨æ€§ (Data Locality)
- å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šå…³ç³»
- å›¾æŸ¥è¯¢è¯­è¨€ (Cypher, SPARQL)

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**å¿…è¯»æ–‡ç« **:
- [MongoDB Schema Design Best Practices](https://www.mongodb.com/developer/products/mongodb/mongodb-schema-design-best-practices/)
- [Neo4j Graph Database Use Cases](https://neo4j.com/use-cases/)

**è§†é¢‘**:
- [SQL vs NoSQL - What's the Difference?](https://www.youtube.com/watch?v=Q_9cX9aKn1Y)

---

### Chapter 3: å­˜å‚¨ä¸æ£€ç´¢

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. æ—¥å¿—ç»“æ„å­˜å‚¨å¼•æ“ (LSM-Tree)
   - SSTable, MemTable
   - Compaction ç­–ç•¥
2. é¢å‘é¡µçš„å­˜å‚¨å¼•æ“ (B-Tree)
   - B-Tree vs B+Tree
   - å†™æ—¶å¤åˆ¶ (COW)
3. å…¶ä»–ç´¢å¼•ç»“æ„
   - äºŒçº§ç´¢å¼•, å…¨æ–‡ç´¢å¼•
   - åœ¨å†…å­˜æ•°æ®åº“ä¸­çš„ç´¢å¼•

**å…³é”®å¯¹æ¯”**:
- LSM-Tree (å†™ä¼˜åŒ–) vs B-Tree (è¯»ä¼˜åŒ–)
- è¡Œå­˜å‚¨ vs åˆ—å­˜å‚¨

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [The Log-Structured Merge-Tree (LSM-Tree)](https://www.cs.umb.edu/~poneil/lsmtree.pdf) - O'Neil et al.
- [The Ubiquitous B-Tree](https://dl.acm.org/doi/10.1145/356770.356776) - Comer, 1979

**å¼€æºé¡¹ç›®**:
- [RocksDB](https://github.com/facebook/rocksdb) - LSM-Tree å®ç°
- [SQLite B-Tree](https://www.sqlite.org/btreemodule.html) - B-Tree å®ç°

**æ–‡ç« **:
- [LSM vs B-Tree: Which is Better?](https://tikv.org/deep-dive/key-value-engine/b-tree-vs-lsm/)

---

### Chapter 4: ç¼–ç ä¸æ¼”åŒ–

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. ç¼–ç æ ¼å¼å¯¹æ¯”
   - JSON, XML, Protocol Buffers, Avro, Thrift
2. æ¨¡å¼æ¼”åŒ–
   - å‘å‰å…¼å®¹ã€å‘åå…¼å®¹
3. æ•°æ®æµæ¨¡å¼
   - æ•°æ®åº“ä¸­çš„æ•°æ®æµ
   - æœåŠ¡é—´çš„æ•°æ®æµ (REST, RPC)
   - å¼‚æ­¥æ¶ˆæ¯ä¼ é€’

**å…³é”®æ¦‚å¿µ**:
- Schema Evolution
- Backward/Forward Compatibility
- RPC vs REST

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**æŠ€æœ¯å¯¹æ¯”**:
- [Protocol Buffers vs JSON: Size and Performance](https://auth0.com/blog/beating-json-performance-with-protobuf/)
- [Avro vs Protobuf vs Thrift](https://martin.kleppmann.com/2012/12/05/schema-evolution-in-avro-protocol-buffers-thrift.html)

---

## ç¬¬äºŒéƒ¨åˆ†: åˆ†å¸ƒå¼æ•°æ®

### Chapter 5: å¤åˆ¶

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. ä¸»ä»å¤åˆ¶ (Leader-Follower)
   - åŒæ­¥å¤åˆ¶ vs å¼‚æ­¥å¤åˆ¶
   - å¤åˆ¶å»¶è¿Ÿé—®é¢˜
2. å¤šä¸»å¤åˆ¶ (Multi-Leader)
   - å†²çªæ£€æµ‹ä¸è§£å†³
   - æ‹“æ‰‘ç»“æ„
3. æ— ä¸»å¤åˆ¶ (Leaderless)
   - Quorum ä¸€è‡´æ€§
   - åç†µä¸è¯»ä¿®å¤

**å…³é”®é—®é¢˜**:
- å¤åˆ¶å»¶è¿Ÿå¯¼è‡´çš„ä¸€è‡´æ€§é—®é¢˜
- å†™å…¥å†²çªçš„è§£å†³ç­–ç•¥
- è¯»å·±ä¹‹å†™ã€å•è°ƒè¯»ã€ä¸€è‡´æ€§å‰ç¼€è¯»

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [Dynamo: Amazon's Highly Available Key-value Store](https://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf)

**æ–‡ç« **:
- [MySQL Replication Explained](https://dev.mysql.com/doc/refman/8.0/en/replication.html)
- [Cassandra Replication Strategy](https://cassandra.apache.org/doc/latest/cassandra/architecture/dynamo.html)

---

### Chapter 6: åˆ†åŒº

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. åˆ†åŒºæ–¹æ³•
   - é”®èŒƒå›´åˆ†åŒº
   - å“ˆå¸Œåˆ†åŒº
2. åˆ†åŒºä¸äºŒçº§ç´¢å¼•
   - åŸºäºæ–‡æ¡£çš„åˆ†åŒº
   - åŸºäºè¯æ¡çš„åˆ†åŒº
3. åˆ†åŒºå†å¹³è¡¡
   - å›ºå®šæ•°é‡åˆ†åŒº
   - åŠ¨æ€åˆ†åŒº
   - æŒ‰èŠ‚ç‚¹æ¯”ä¾‹åˆ†åŒº

**å…³é”®æ¦‚å¿µ**:
- Consistent Hashing
- Hot Spot (çƒ­ç‚¹)
- Skewed Workload (å€¾æ–œè´Ÿè½½)

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [Consistent Hashing and Random Trees](https://www.akamai.com/content/dam/site/en/documents/research-paper/consistent-hashing-and-random-trees-distributed-caching-protocols-for-relieving-hot-spots-on-the-world-wide-web-technical-publication.pdf) - Karger et al.

**æ–‡ç« **:
- [Consistent Hashing in Practice](https://www.toptal.com/big-data/consistent-hashing)
- [Cassandra Partitioning](https://cassandra.apache.org/doc/latest/cassandra/architecture/dynamo.html#dataset-partitioning-consistent-hashing)

---

### Chapter 7: äº‹åŠ¡

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. ACID çš„å«ä¹‰
   - åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§
2. å¼±éš”ç¦»çº§åˆ«
   - è¯»å·²æäº¤
   - å¿«ç…§éš”ç¦» (MVCC)
   - å¯é‡å¤è¯»
3. å¯ä¸²è¡ŒåŒ–
   - çœŸæ­£çš„ä¸²è¡Œæ‰§è¡Œ
   - ä¸¤é˜¶æ®µé” (2PL)
   - å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦» (SSI)

**å…³é”®é—®é¢˜**:
- è„è¯»ã€è„å†™ã€å¹»è¯»
- å†™å€¾æ–œã€ä¸¢å¤±æ›´æ–°
- MVCC çš„å®ç°åŸç†

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [A Critique of ANSI SQL Isolation Levels](https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/tr-95-51.pdf) - Berenson et al.

**æ–‡ç« **:
- [PostgreSQL MVCC Explained](https://www.postgresql.org/docs/current/mvcc.html)
- [MySQL InnoDB MVCC](https://dev.mysql.com/doc/refman/8.0/en/innodb-multi-versioning.html)

---

### Chapter 8: åˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦

**é˜…è¯»çŠ¶æ€**: âœ… å·²å®Œæˆ | **æ—¥æœŸ**: 2025-10-16

> è¿™ä¸€ç« æ­ç¤ºäº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ®‹é…·ç°å®:ç½‘ç»œä¸å¯é ã€æ—¶é’Ÿä¸å¯ä¿¡ã€èŠ‚ç‚¹éšæ—¶å¯èƒ½å¤±æ•ˆ

#### æ ¸å¿ƒæ¦‚å¿µ

**æœ¬ç« ä¸»é¢˜**: åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é‚£äº›ä¸å¯é¿å…çš„ã€è¿èƒŒç›´è§‰çš„é—®é¢˜

---

### 1ï¸âƒ£ æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ

#### å•æœºç³»ç»Ÿ vs åˆ†å¸ƒå¼ç³»ç»Ÿ

**å•æœºç³»ç»Ÿçš„ç‰¹ç‚¹**:
- è¦ä¹ˆå…¨éƒ¨å·¥ä½œ,è¦ä¹ˆå®Œå…¨å¤±æ•ˆ(ç¡®å®šæ€§)
- ç¡¬ä»¶è®¾è®¡ä¸º"å…¨æœ‰æˆ–å…¨æ— "
- è½¯ä»¶ bug æ˜¯ç¡®å®šæ€§çš„(ç›¸åŒè¾“å…¥æ€»æ˜¯ç›¸åŒè¾“å‡º)

**åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç‰¹ç‚¹**:
- **éƒ¨åˆ†å¤±æ•ˆ (Partial Failure)** æ˜¯å¸¸æ€
- æŸäº›èŠ‚ç‚¹æ­£å¸¸,æŸäº›èŠ‚ç‚¹å¤±æ•ˆ
- ç³»ç»Ÿéƒ¨åˆ†å¯ç”¨,éƒ¨åˆ†ä¸å¯ç”¨
- **ä¸ç¡®å®šæ€§ (Nondeterminism)** æ˜¯æ ¸å¿ƒæŒ‘æˆ˜

#### éƒ¨åˆ†å¤±æ•ˆçš„ä¾‹å­

```
åœºæ™¯: åˆ†å¸ƒå¼æ•°æ®åº“,3 ä¸ªèŠ‚ç‚¹

æ­£å¸¸æƒ…å†µ:
èŠ‚ç‚¹A: âœ… æ­£å¸¸
èŠ‚ç‚¹B: âœ… æ­£å¸¸
èŠ‚ç‚¹C: âœ… æ­£å¸¸

éƒ¨åˆ†å¤±æ•ˆ:
èŠ‚ç‚¹A: âœ… æ­£å¸¸
èŠ‚ç‚¹B: âŒ ç½‘ç»œä¸å¯è¾¾ (åˆ°åº•æ˜¯å®•æœºè¿˜æ˜¯ç½‘ç»œé—®é¢˜?)
èŠ‚ç‚¹C: âœ… æ­£å¸¸

é—®é¢˜: æ— æ³•åŒºåˆ†èŠ‚ç‚¹Bæ˜¯å®•æœºè¿˜æ˜¯ç½‘ç»œæ•…éšœ!
```

**å…³é”®æ´å¯Ÿ**: åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­,ä½ æ— æ³•ç¡®å®šè¿œç¨‹èŠ‚ç‚¹çš„çŠ¶æ€

---

### 2ï¸âƒ£ ä¸å¯é çš„ç½‘ç»œ

#### ç½‘ç»œæ•…éšœçš„ç°å®

**ç½‘ç»œå¹¶ä¸åƒæˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆå¯é **

**å¸¸è§ç½‘ç»œé—®é¢˜**:
1. **è¯·æ±‚ä¸¢å¤±** - æ•°æ®åŒ…åœ¨ä¼ è¾“ä¸­ä¸¢å¤±
2. **è¯·æ±‚æ’é˜Ÿ** - ç½‘ç»œæ‹¥å¡,è¯·æ±‚è¢«å»¶è¿Ÿ
3. **è¿œç¨‹èŠ‚ç‚¹å¤±æ•ˆ** - ç›®æ ‡èŠ‚ç‚¹å´©æºƒ
4. **è¿œç¨‹èŠ‚ç‚¹ä¸´æ—¶åœæ­¢å“åº”** - GC æš‚åœã€CPU å æ»¡
5. **å“åº”ä¸¢å¤±** - å“åº”åŒ…åœ¨è¿”å›é€”ä¸­ä¸¢å¤±
6. **å“åº”å»¶è¿Ÿ** - å“åº”è¢«ä¸¥é‡å»¶è¿Ÿ

**æ ¸å¿ƒé—®é¢˜**: å‘é€è¯·æ±‚åæ²¡æœ‰æ”¶åˆ°å“åº”,ä½ æ— æ³•åŒºåˆ†è¿™äº›æƒ…å†µ!

#### çœŸå®ä¸–ç•Œçš„ç½‘ç»œæ•…éšœ

**æ¡ˆä¾‹: Aphyr çš„ç½‘ç»œåˆ†åŒºå®éªŒ**
- æµ‹è¯•äº†å¤šä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿ
- å‘ç°å¤§å¤šæ•°ç³»ç»Ÿåœ¨ç½‘ç»œåˆ†åŒºæ—¶è¡¨ç°ä¸ä½³
- æ•°æ®ä¸¢å¤±ã€ä¸€è‡´æ€§è¿èƒŒã€è„‘è£‚é—®é¢˜

**ç»Ÿè®¡æ•°æ®** (æ¥è‡ªçœŸå®ç”Ÿäº§ç¯å¢ƒ):
- ä¸­å‹æ•°æ®ä¸­å¿ƒ: 12 æ¬¡ç½‘ç»œæ•…éšœ/æœˆ
- ç½‘ç»œå»¶è¿Ÿ P99.9: å¯èƒ½æ¯”ä¸­ä½æ•°é«˜ 10 å€ä»¥ä¸Š
- äº¤æ¢æœºæ•…éšœ: å¯¼è‡´å¤§è§„æ¨¡è¿æ¥ä¸­æ–­

**æ•°æ®ä¸­å¿ƒç½‘ç»œ vs äº’è”ç½‘**:
- æ•°æ®ä¸­å¿ƒå†…: ç›¸å¯¹å¯é ,ä½†ä»æœ‰æ•…éšœ
- è·¨æ•°æ®ä¸­å¿ƒ: æ•…éšœç‡æ›´é«˜
- ç§»åŠ¨ç½‘ç»œ: æä¸å¯é 

#### è¶…æ—¶ä¸æ— é™ç­‰å¾…

**é—®é¢˜**: è¯·æ±‚å‘å‡ºå,åº”è¯¥ç­‰å¤šä¹…?

**æƒè¡¡**:
- **è¶…æ—¶å¤ªçŸ­**: è¯¯åˆ¤èŠ‚ç‚¹å¤±æ•ˆ,å¯¼è‡´ä¸å¿…è¦çš„æ•…éšœè½¬ç§»
- **è¶…æ—¶å¤ªé•¿**: çœŸæ­£æ•…éšœæ—¶æ¢å¤æ—¶é—´é•¿,å½±å“ç”¨æˆ·ä½“éªŒ

**æ²¡æœ‰å®Œç¾çš„è¶…æ—¶æ—¶é—´**:
- ç½‘ç»œå»¶è¿Ÿæ˜¯å˜åŒ–çš„(P50 vs P99 å·®å¼‚å·¨å¤§)
- èŠ‚ç‚¹å¤„ç†æ—¶é—´ä¹Ÿæ˜¯å˜åŒ–çš„(GC æš‚åœ)

**å®è·µæ–¹æ³•**:
1. **åŠ¨æ€è°ƒæ•´è¶…æ—¶**: æ ¹æ®å“åº”æ—¶é—´åˆ†å¸ƒè‡ªåŠ¨è°ƒæ•´
2. **Phi Accrual Failure Detector**: ä¸æ˜¯äºŒå…ƒåˆ¤æ–­,è€Œæ˜¯ç»™å‡ºæ•…éšœæ¦‚ç‡
3. **å¤šæ¬¡æ¢æµ‹**: é¿å…å•æ¬¡è¶…æ—¶å°±åˆ¤å®šå¤±æ•ˆ

#### ç½‘ç»œæ‹¥å¡ä¸æ’é˜Ÿ

**æ•°æ®åŒ…åœ¨å“ªé‡Œæ’é˜Ÿ?**

1. **ç½‘ç»œäº¤æ¢æœºé˜Ÿåˆ—**
   - å¤šä¸ªèŠ‚ç‚¹åŒæ—¶å‘é€åˆ°åŒä¸€ç›®æ ‡
   - äº¤æ¢æœºç«¯å£å¸¦å®½é¥±å’Œ,æ•°æ®åŒ…æ’é˜Ÿ

2. **æ“ä½œç³»ç»Ÿé˜Ÿåˆ—**
   - CPU è¢«å æ»¡,ç½‘ç»œæ•°æ®åŒ…åœ¨ OS å±‚æ’é˜Ÿ
   - è™šæ‹Ÿæœºäº‰å¤º CPU,å¯¼è‡´é¢å¤–å»¶è¿Ÿ

3. **TCP æµæ§åˆ¶**
   - æ¥æ”¶æ–¹å¤„ç†ä¸è¿‡æ¥,å‘é€æ–¹è¢«é™é€Ÿ

4. **åº”ç”¨å±‚é˜Ÿåˆ—**
   - æ¶ˆæ¯é˜Ÿåˆ—ã€çº¿ç¨‹æ± æ»¡äº†
   - è¯·æ±‚åœ¨åº”ç”¨å†…éƒ¨æ’é˜Ÿ

**å…³é”®æ´å¯Ÿ**: å¯å˜å»¶è¿Ÿçš„ä¸»è¦æ¥æºæ˜¯**æ’é˜Ÿ**

**è§£å†³æ–¹æ¡ˆ**:
- **å®éªŒæ€§æµ‹é‡**: æŒç»­ç›‘æ§ç½‘ç»œå»¶è¿Ÿåˆ†å¸ƒ
- **è¿‡è½½ä¿æŠ¤**: é™æµã€ç†”æ–­ã€é™çº§
- **æµé‡æ•´å½¢**: é¿å…çªå‘æµé‡

---

### 3ï¸âƒ£ ä¸å¯é çš„æ—¶é’Ÿ

#### æ—¶é’Ÿçš„ä¸¤ç§ç±»å‹

**1. å¢™ä¸Šæ—¶é’Ÿ (Time-of-Day Clock)**

**ç‰¹ç‚¹**:
- è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´(å¦‚ 2025-10-16 14:30:00)
- å¯¹åº” UNIX æ—¶é—´æˆ³
- å¯ä»¥é€šè¿‡ NTP åŒæ­¥

**é—®é¢˜**:
- **å¯ä»¥å›æ‹¨** - NTP å‘ç°æ—¶é’Ÿå¿«äº†,ä¼šå‘åè°ƒæ•´
- **è·³è·ƒæ€§å˜åŒ–** - é—°ç§’ã€æ—¶åŒºè°ƒæ•´
- **ä¸é€‚åˆæµ‹é‡æŒç»­æ—¶é—´**

**ç”¨é€”**: è®°å½•äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ç‚¹

**2. å•è°ƒæ—¶é’Ÿ (Monotonic Clock)**

**ç‰¹ç‚¹**:
- ä¿è¯å•è°ƒé€’å¢
- é€‚åˆæµ‹é‡æ—¶é—´é—´éš”(å¦‚ 5 ç§’åè¶…æ—¶)
- ä¸å¯¹åº”ç°å®ä¸–ç•Œæ—¶é—´
- **ä¸èƒ½è·¨èŠ‚ç‚¹æ¯”è¾ƒ**

**ç”¨é€”**: è¶…æ—¶ã€æ€§èƒ½æµ‹é‡ã€é€Ÿç‡é™åˆ¶

#### æ—¶é’ŸåŒæ­¥çš„ç°å®

**NTP åŒæ­¥å¹¶ä¸å®Œç¾**:

**å»¶è¿Ÿé—®é¢˜**:
```
å®¢æˆ·ç«¯å‘é€è¯·æ±‚: T1 = 10:00:00.000
æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚: T2 = 10:00:00.050 (æœåŠ¡å™¨æ—¶é—´)
æœåŠ¡å™¨å‘é€å“åº”: T3 = 10:00:00.051 (æœåŠ¡å™¨æ—¶é—´)
å®¢æˆ·ç«¯æ¥æ”¶å“åº”: T4 = 10:00:00.100

ç½‘ç»œå»¶è¿Ÿ: (T4 - T1) - (T3 - T2) = 100ms - 1ms = 99ms
æ—¶é’Ÿåç§»: ((T2 - T1) + (T3 - T4)) / 2

é—®é¢˜: å‡è®¾å¾€è¿”å»¶è¿Ÿå¯¹ç§°(å®é™…ä¸Šä¸ä¸€å®š!)
```

**ç²¾åº¦é™åˆ¶**:
- å…¬ç½‘ NTP: Â±35 æ¯«ç§’(Google æŠ¥å‘Š)
- æœ¬åœ° NTP: Â±1 æ¯«ç§’
- GPS æ¥æ”¶å™¨: Â±1 å¾®ç§’
- åŸå­é’Ÿ: æé«˜ç²¾åº¦,ä½†æ˜‚è´µ

**æ—¶é’Ÿæ¼‚ç§»**:
- çŸ³è‹±é’Ÿæ¯å¤©æ¼‚ç§»: Â±17 ç§’
- éœ€è¦æŒç»­åŒæ­¥
- è™šæ‹Ÿæœºçš„æ—¶é’Ÿæ›´ä¸å¯é 

#### ä¾èµ–æ—¶é’Ÿçš„å±é™©

**æ¡ˆä¾‹ 1: Last Write Wins (LWW)**

```
åœºæ™¯: åˆ†å¸ƒå¼æ•°æ®åº“,ç”¨æ—¶é—´æˆ³è§£å†³å†™å†²çª

èŠ‚ç‚¹ A çš„æ—¶é’Ÿ: 10:00:00.000 (å®é™…æ…¢äº† 1 ç§’)
èŠ‚ç‚¹ B çš„æ—¶é’Ÿ: 10:00:01.000 (æ­£ç¡®)

å®¢æˆ·ç«¯ 1 â†’ èŠ‚ç‚¹ A: å†™å…¥ x=1, timestamp=10:00:00.000
å®¢æˆ·ç«¯ 2 â†’ èŠ‚ç‚¹ B: å†™å…¥ x=2, timestamp=10:00:01.000

ç»“æœ: x=2 èƒœå‡º (å› ä¸ºæ—¶é—´æˆ³æ›´æ–°)
å®é™…: å®¢æˆ·ç«¯ 1 å¯èƒ½æ˜¯åå†™å…¥çš„,ä½†å› ä¸ºæ—¶é’Ÿæ…¢,è¢«è¦†ç›–!

æ•°æ®ä¸¢å¤±! âŒ
```

**æ¡ˆä¾‹ 2: åˆ†å¸ƒå¼é”**

```
åœºæ™¯: ä½¿ç”¨ç§Ÿçº¦(lease)å®ç°åˆ†å¸ƒå¼é”

å®¢æˆ·ç«¯ 1 è·å¾—é”,ç§Ÿçº¦åˆ° 10:00:10
å®¢æˆ·ç«¯ 1 å‘ç”Ÿ GC æš‚åœ 15 ç§’
å®¢æˆ·ç«¯ 1 ä»¥ä¸ºé”è¿˜æœ‰æ•ˆ(æœ¬åœ°æ—¶é’Ÿå‡ºé”™)
å®¢æˆ·ç«¯ 2 å·²ç»è·å¾—é”
ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶æ“ä½œæ•°æ®!

å®‰å…¨æ€§è¿èƒŒ! âŒ
```

**æ¡ˆä¾‹ 3: æœ‰åºäº‹ä»¶æ’åº**

```
åœºæ™¯: ç”¨æ—¶é—´æˆ³ç»™äº‹ä»¶æ’åº

æœåŠ¡å™¨ A: äº‹ä»¶ E1, timestamp=10:00:00.100
æœåŠ¡å™¨ B: äº‹ä»¶ E2, timestamp=10:00:00.050 (æ—¶é’Ÿæ…¢)

å¦‚æœ E2 å®é™…å‘ç”Ÿåœ¨ E1 ä¹‹å,ä½†æ—¶é—´æˆ³æ›´å°
æ’åºé”™è¯¯!
```

#### æ—¶é’Ÿçš„æ­£ç¡®ç”¨æ³•

**âœ… å¯ä»¥ä¾èµ–æ—¶é’Ÿçš„åœºæ™¯**:
- æ—¥å¿—æ—¶é—´æˆ³(ä¸éœ€è¦ç»å¯¹ç²¾ç¡®)
- ç¼“å­˜è¿‡æœŸæ—¶é—´(å®¹å¿ä¸€å®šè¯¯å·®)
- ç›‘æ§æŒ‡æ ‡æ—¶é—´

**âŒ ä¸èƒ½ä¾èµ–æ—¶é’Ÿçš„åœºæ™¯**:
- åˆ†å¸ƒå¼é”çš„æ­£ç¡®æ€§
- äº‹ä»¶çš„å› æœå…³ç³»
- è·¨èŠ‚ç‚¹çš„ä¸¥æ ¼æ’åº

**æ­£ç¡®çš„æ›¿ä»£æ–¹æ¡ˆ**:
- **é€»è¾‘æ—¶é’Ÿ** (Lamport Timestamp, Vector Clock)
- **è‡ªå¢ ID** (Snowflake)
- **å…±è¯†ç®—æ³•** (Raft, Paxos)

---

### 4ï¸âƒ£ è¿›ç¨‹æš‚åœ

#### GC å¯¼è‡´çš„æš‚åœ

**é—®é¢˜**: åº”ç”¨ç¨‹åºå¯èƒ½åœ¨ä»»æ„æ—¶åˆ»æš‚åœ

**æ¡ˆä¾‹: Java GC æš‚åœ**
```
çº¿ç¨‹ A: æŒæœ‰åˆ†å¸ƒå¼é”
GC æš‚åœ 15 ç§’ (Stop-the-World)
é”çš„ç§Ÿçº¦è¿‡æœŸ
çº¿ç¨‹ B: è·å¾—é”
çº¿ç¨‹ A: æ¢å¤æ‰§è¡Œ,ä»¥ä¸ºè‡ªå·±è¿˜æŒæœ‰é”
ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œæ•°æ®! âŒ
```

**å…¶ä»–å¯¼è‡´æš‚åœçš„åŸå› **:
- è™šæ‹Ÿæœºè¢«æŒ‚èµ·(VM live migration)
- æ“ä½œç³»ç»Ÿä¸Šä¸‹æ–‡åˆ‡æ¢
- ç£ç›˜ I/O é˜»å¡(page fault)
- SIGSTOP ä¿¡å·
- ç¬”è®°æœ¬åˆç›–(suspend)

**å…³é”®æ´å¯Ÿ**: å•çº¿ç¨‹ä»£ç åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ä¸å†æœ‰æ—¶é—´ä¿è¯

#### å“åº”æ—¶é—´ä¿è¯

**ç¡¬å®æ—¶ç³»ç»Ÿ (Hard Real-Time)**:
- èˆªç©ºç”µå­ã€æ±½è½¦å®‰å…¨ç³»ç»Ÿ
- å¿…é¡»åœ¨æˆªæ­¢æ—¶é—´å†…å®Œæˆ,å¦åˆ™ç¾éš¾æ€§åæœ
- éœ€è¦ç‰¹æ®Šç¡¬ä»¶å’Œ RTOS(å®æ—¶æ“ä½œç³»ç»Ÿ)
- ä¸ä½¿ç”¨ GCã€åŠ¨æ€å†…å­˜åˆ†é…

**è½¯å®æ—¶ç³»ç»Ÿ (Soft Real-Time)**:
- è§†é¢‘ä¼šè®®ã€åœ¨çº¿æ¸¸æˆ
- å°½é‡ä¿è¯ä½å»¶è¿Ÿ,ä½†å¶å°”è¿èƒŒå¯æ¥å—

**æ™®é€šæœåŠ¡å™¨ç³»ç»Ÿ**:
- æ²¡æœ‰å“åº”æ—¶é—´ä¿è¯
- è¿½æ±‚é«˜ååé‡ > ä½å»¶è¿Ÿä¿è¯
- GCã€è™šæ‹ŸåŒ–ã€åˆ†æ—¶å¤šä»»åŠ¡

**åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å½±å“**:
- ç§Ÿçº¦ã€è¶…æ—¶ã€æ•…éšœæ£€æµ‹éƒ½å¯èƒ½å› æš‚åœè€Œè¯¯åˆ¤
- éœ€è¦è®¾è®¡èƒ½å®¹å¿æš‚åœçš„ç®—æ³•

---

### 5ï¸âƒ£ çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€

#### çœŸç›¸ç”±å¤šæ•°æ´¾å®šä¹‰

**é—®é¢˜**: èŠ‚ç‚¹æ— æ³•ç¡®å®šè‡ªå·±çš„çŠ¶æ€

**æ¡ˆä¾‹: è„‘è£‚ (Split Brain)**
```
é›†ç¾¤: èŠ‚ç‚¹ A(Leader), èŠ‚ç‚¹ B, èŠ‚ç‚¹ C

ç½‘ç»œåˆ†åŒº:
- èŠ‚ç‚¹ A æ— æ³•è¿æ¥ Bã€C
- èŠ‚ç‚¹ Bã€C å¯ä»¥äº’ç›¸è¿æ¥

èŠ‚ç‚¹ A çš„è§†è§’:
- æˆ‘æ˜¯ Leader
- B å’Œ C å¤±æ•ˆäº†

èŠ‚ç‚¹ Bã€C çš„è§†è§’:
- Leader A å¤±æ•ˆäº†
- é€‰ä¸¾æ–° Leader

ç»“æœ: ä¸¤ä¸ª Leader! âŒ
```

**è§£å†³æ–¹æ¡ˆ: Quorum (æ³•å®šäººæ•°)**
```
é›†ç¾¤ 3 ä¸ªèŠ‚ç‚¹,Quorum = 2

èŠ‚ç‚¹ A è¢«éš”ç¦»:
- æ— æ³•è”ç³»åˆ°å¤šæ•°æ´¾(2 ä¸ªèŠ‚ç‚¹)
- ä¸»åŠ¨æ”¾å¼ƒ Leader èº«ä»½

èŠ‚ç‚¹ Bã€C:
- å¯ä»¥å½¢æˆå¤šæ•°æ´¾
- é€‰ä¸¾æ–° Leader

ç¡®ä¿åªæœ‰ä¸€ä¸ª Leader âœ…
```

#### Fencing Token (éš”ç¦»ä»¤ç‰Œ)

**é—®é¢˜**: æ—§ Leader å¯èƒ½ä¸çŸ¥é“è‡ªå·±å·²è¢«æ›¿æ¢

**è§£å†³æ–¹æ¡ˆ: å•è°ƒé€’å¢çš„ Token**

```
1. é”æœåŠ¡(å¦‚ Zookeeper)ä¸ºæ¯æ¬¡é”æˆäºˆåˆ†é…é€’å¢çš„ Token
   å®¢æˆ·ç«¯ 1 è·å¾—é”, Token=33
   å®¢æˆ·ç«¯ 2 è·å¾—é”, Token=34

2. å®¢æˆ·ç«¯æºå¸¦ Token è®¿é—®èµ„æº
   å®¢æˆ·ç«¯ 1: å†™å…¥è¯·æ±‚, Token=33
   å®¢æˆ·ç«¯ 2: å†™å…¥è¯·æ±‚, Token=34

3. å­˜å‚¨æœåŠ¡æ‹’ç»æ—§ Token çš„è¯·æ±‚
   æ”¶åˆ° Token=33 çš„è¯·æ±‚ â†’ æ‹’ç»(å·²ç»çœ‹åˆ° Token=34)
   æ”¶åˆ° Token=34 çš„è¯·æ±‚ â†’ æ¥å—

å³ä½¿å®¢æˆ·ç«¯ 1 GC æš‚åœåæ¢å¤,ä¹Ÿæ— æ³•ç ´åå®‰å…¨æ€§ âœ…
```

**å…³é”®ç‚¹**:
- Token å¿…é¡»å•è°ƒé€’å¢
- èµ„æºå¿…é¡»æ£€æŸ¥å¹¶æ‹’ç»æ—§ Token
- ç±»ä¼¼äº Raft çš„ term number

#### æ‹œå åº­æ•…éšœ

**éæ‹œå åº­æ•…éšœ (Crash-Stop Fault)**:
- èŠ‚ç‚¹å´©æºƒã€ç½‘ç»œæ•…éšœã€è¿›ç¨‹æš‚åœ
- èŠ‚ç‚¹"è¯šå®",ä¸ä¼šè¯´è°

**æ‹œå åº­æ•…éšœ (Byzantine Fault)**:
- èŠ‚ç‚¹å¯èƒ½å‘é€è™šå‡ä¿¡æ¯
- æ¶æ„è¡Œä¸ºæˆ–è½¯ä»¶ bug

**æ‹œå åº­å°†å†›é—®é¢˜**:
```
åœºæ™¯: å¤šä¸ªå°†å†›å›´æ”»åŸå¸‚,éœ€è¦åè°ƒä¸€è‡´è¡ŒåŠ¨

æŒ‘æˆ˜:
- å°†å†›é—´é€šè¿‡ä¿¡ä½¿ä¼ é€’æ¶ˆæ¯
- æŸäº›å°†å†›æ˜¯å›å¾’,ä¼šå‘é€è™šå‡æ¶ˆæ¯
- å¦‚ä½•è®©å¿ è¯šå°†å†›è¾¾æˆä¸€è‡´?

è§£å†³æ–¹æ¡ˆ:
- éœ€è¦è‡³å°‘ 3f+1 ä¸ªå°†å†›æ‰èƒ½å®¹å¿ f ä¸ªå›å¾’
- æ‹œå åº­å®¹é”™ç®—æ³•(PBFTã€åŒºå—é“¾å…±è¯†)
```

**å®é™…åº”ç”¨**:
- **åŒºå—é“¾**: èŠ‚ç‚¹å¯èƒ½æ˜¯æ¶æ„çš„
- **èˆªç©ºèˆªå¤©**: è¾å°„å¯èƒ½å¯¼è‡´ä½ç¿»è½¬
- **å¤šç»„ç»‡ç³»ç»Ÿ**: ä¸åŒå…¬å¸è¿è¡ŒèŠ‚ç‚¹,äº’ä¸ä¿¡ä»»

**å¤§å¤šæ•°ç³»ç»Ÿå‡è®¾**:
- èŠ‚ç‚¹æ˜¯è¯šå®çš„,ä½†å¯èƒ½æ•…éšœ
- ä½¿ç”¨æ›´ç®€å•çš„ç®—æ³•(Raftã€Paxos)

---

### 6ï¸âƒ£ ç³»ç»Ÿæ¨¡å‹ä¸ç°å®

#### ç³»ç»Ÿæ¨¡å‹çš„ä¸‰ç§ç±»å‹

**1. åŒæ­¥æ¨¡å‹ (Synchronous Model)**
- ç½‘ç»œå»¶è¿Ÿæœ‰ä¸Šç•Œ
- è¿›ç¨‹æš‚åœæœ‰ä¸Šç•Œ
- æ—¶é’Ÿè¯¯å·®æœ‰ç•Œ

**ç‰¹ç‚¹**: ç†æƒ³åŒ–,ç°å®ä¸­å¾ˆéš¾å®ç°

**2. éƒ¨åˆ†åŒæ­¥æ¨¡å‹ (Partially Synchronous Model)**
- å¤§éƒ¨åˆ†æ—¶é—´è¡¨ç°è‰¯å¥½
- å¶å°”è¶…å‡ºç•Œé™

**ç‰¹ç‚¹**: æ›´æ¥è¿‘ç°å®(Raftã€Paxos å‡è®¾è¿™ç§æ¨¡å‹)

**3. å¼‚æ­¥æ¨¡å‹ (Asynchronous Model)**
- æ²¡æœ‰ä»»ä½•æ—¶é—´å‡è®¾
- æ²¡æœ‰æ—¶é’Ÿ,æ²¡æœ‰è¶…æ—¶

**ç‰¹ç‚¹**: æç«¯ä¿å®ˆ,ä½†æœ‰ç†è®ºä»·å€¼

#### FLP ä¸å¯èƒ½æ€§å®šç†

**FLP Theorem** (Fischer, Lynch, Paterson, 1985):

> åœ¨å¼‚æ­¥ç³»ç»Ÿä¸­,å³ä½¿åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½å¤±æ•ˆ,ä¹Ÿä¸å­˜åœ¨ç¡®å®šæ€§çš„å…±è¯†ç®—æ³•

**å«ä¹‰**:
- åœ¨æœ€æ¶åŠ£çš„æƒ…å†µä¸‹,å…±è¯†ç®—æ³•å¯èƒ½æ°¸è¿œæ— æ³•ç»ˆæ­¢
- ä½†å®è·µä¸­,é€šè¿‡è¶…æ—¶ã€éšæœºåŒ–å¯ä»¥è§£å†³(Raftã€Paxos)

---

### å…³é”®æ´å¯Ÿ

1. **åˆ†å¸ƒå¼ç³»ç»Ÿå……æ»¡ä¸ç¡®å®šæ€§**
   - ç½‘ç»œä¸å¯é 
   - æ—¶é’Ÿä¸å¯ä¿¡
   - è¿›ç¨‹ä¼šæš‚åœ

2. **æ— æ³•åŒºåˆ†æ…¢å’Œæ­»**
   - è¶…æ—¶ä¸èƒ½ç¡®å®šèŠ‚ç‚¹æ˜¯å¦çœŸçš„å¤±æ•ˆ
   - åªèƒ½åšå‡ºæ¦‚ç‡æ€§åˆ¤æ–­

3. **çœŸç›¸ç”±å¤šæ•°æ´¾å®šä¹‰**
   - å•ä¸ªèŠ‚ç‚¹æ— æ³•ç¡®å®šè‡ªå·±çš„çŠ¶æ€
   - éœ€è¦ Quorum æœºåˆ¶

4. **æ—¶é’Ÿåªèƒ½ç”¨äºè¿‘ä¼¼**
   - ä¸èƒ½ä¾èµ–æ—¶é’Ÿåšç²¾ç¡®åˆ¤æ–­
   - ä½¿ç”¨é€»è¾‘æ—¶é’Ÿã€å…±è¯†ç®—æ³•

5. **ç®—æ³•å¿…é¡»å®¹å¿éƒ¨åˆ†å¤±æ•ˆ**
   - è®¾è®¡æ—¶å‡è®¾æœ€åæƒ…å†µ
   - ä½¿ç”¨ Fencing Token ç­‰æœºåˆ¶ä¿è¯å®‰å…¨æ€§

---

### å»¶ä¼¸é˜…è¯»

**ç»å…¸è®ºæ–‡**:
- [Time, Clocks, and the Ordering of Events in a Distributed System](https://lamport.azurewebsites.net/pubs/time-clocks.pdf) - Lamport, 1978 (é€»è¾‘æ—¶é’Ÿçš„å¼€åˆ›æ€§å·¥ä½œ)
- [Impossibility of Distributed Consensus with One Faulty Process](https://groups.csail.mit.edu/tds/papers/Lynch/jacm85.pdf) - FLP, 1985
- [Unreliable Failure Detectors for Reliable Distributed Systems](https://www.cs.utexas.edu/~lorenzo/corsi/cs380d/papers/p225-chandra.pdf) - Chandra & Toueg, 1996

**æŠ€æœ¯æ–‡ç« **:
- [The Network is Reliable](https://aphyr.com/posts/288-the-network-is-reliable) - Aphyr (åè®½æ ‡é¢˜,æ­ç¤ºç½‘ç»œçš„ä¸å¯é æ€§)
- [There is No Now](https://queue.acm.org/detail.cfm?id=2745385) - æ—¶é’Ÿåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„é—®é¢˜
- [Jepsen: Testing the Partition Tolerance of Distributed Systems](https://aphyr.com/tags/jepsen) - Kyle Kingsbury çš„åˆ†å¸ƒå¼ç³»ç»Ÿæµ‹è¯•

**è§†é¢‘èµ„æº**:
- [Distributed Systems Lecture - Lamport Clocks](https://www.youtube.com/watch?v=x-D8iFU1d-o) - Martin Kleppmann
- [The Trouble with Timestamps](https://www.youtube.com/watch?v=BhosKsE8up8)

**ç›¸å…³ä¹¦ç±**:
- ã€ŠTime, Clocks, and the Ordering of Eventsã€‹ - Lamport çš„ç»å…¸è®ºæ–‡
- ã€ŠDistributed Systems: Principles and Paradigmsã€‹ - Tanenbaum

---

### å®è·µç»ƒä¹ 

**ç»ƒä¹  1: ç½‘ç»œè¶…æ—¶è®¾è®¡**

åœºæ™¯: è®¾è®¡ä¸€ä¸ªåˆ†å¸ƒå¼ RPC æ¡†æ¶çš„è¶…æ—¶æœºåˆ¶

æ€è€ƒ:
- å¦‚ä½•è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´?
- å¦‚ä½•åŒºåˆ†æ…¢å“åº”å’ŒèŠ‚ç‚¹å¤±æ•ˆ?
- å¦‚ä½•é¿å…è¯¯åˆ¤å¯¼è‡´çš„é›ªå´©?

å‚è€ƒæ–¹æ¡ˆ:
- åŠ¨æ€è¶…æ—¶(åŸºäº P99 å»¶è¿Ÿ)
- é‡è¯•æœºåˆ¶(æŒ‡æ•°é€€é¿)
- ç†”æ–­å™¨æ¨¡å¼

**ç»ƒä¹  2: åˆ†å¸ƒå¼é”å®‰å…¨æ€§**

åœºæ™¯: å®ç°ä¸€ä¸ªå®‰å…¨çš„åˆ†å¸ƒå¼é”

è¦æ±‚:
- å®¹å¿ GC æš‚åœ
- é˜²æ­¢è„‘è£‚
- ä½¿ç”¨ Fencing Token

å®ç°æ­¥éª¤:
1. ä½¿ç”¨ Zookeeper/etcd ç®¡ç†é”
2. æ¯æ¬¡æˆäºˆé”æ—¶åˆ†é…é€’å¢çš„ Token
3. èµ„æºæ£€æŸ¥ Token,æ‹’ç»æ—§ Token çš„è¯·æ±‚

**ç»ƒä¹  3: æ—¶é’Ÿä¾èµ–åˆ†æ**

åˆ†æä»¥ä¸‹åœºæ™¯æ˜¯å¦å®‰å…¨:
1. ç”¨æœ¬åœ°æ—¶é—´æˆ³ä½œä¸ºæ—¥å¿—æ–‡ä»¶å â†’ å®‰å…¨ âœ…
2. ç”¨æ—¶é—´æˆ³ä½œä¸ºåˆ†å¸ƒå¼äº‹åŠ¡ ID â†’ ä¸å®‰å…¨ âŒ
3. ç”¨æ—¶é—´æˆ³åˆ¤æ–­ç¼“å­˜æ˜¯å¦è¿‡æœŸ â†’ åŸºæœ¬å®‰å…¨ âœ…
4. ç”¨æ—¶é—´æˆ³æ’åºåˆ†å¸ƒå¼äº‹ä»¶ â†’ ä¸å®‰å…¨ âŒ

**ç»ƒä¹  4: Quorum è®¡ç®—**

ç»™å®šé›†ç¾¤è§„æ¨¡ N,è®¡ç®—:
- å†™ Quorum: W
- è¯» Quorum: R
- å®¹é”™æ•°: F

æ¡ä»¶: W + R > N, F = floor((N-1)/2)

| N | W | R | F |
|---|---|---|---|
| 3 | 2 | 2 | 1 |
| 5 | 3 | 3 | 2 |
| 7 | 4 | 4 | 3 |

---

### æˆ‘çš„æ€è€ƒ

**é—®é¢˜**:
- â“ ä¸ºä»€ä¹ˆ Google Spanner æ•¢ä½¿ç”¨æ—¶é—´æˆ³(TrueTime)?
- â“ å¦‚æœæ—¶é’Ÿä¸å¯ä¿¡,å¦‚ä½•å®ç°å…¨å±€æœ‰åºçš„äº‹ä»¶æ—¥å¿—?
- â“ æ‹œå åº­å®¹é”™ç®—æ³•çš„æ€§èƒ½ä¸ºä»€ä¹ˆè¿™ä¹ˆå·®?

**ç­”æ¡ˆè¦ç‚¹**:
- **TrueTime**: Google ä½¿ç”¨åŸå­é’Ÿ + GPS,è¯¯å·®æå°(Â±7ms),ä¸” API è¿”å›æ—¶é—´åŒºé—´è€Œéå•ä¸€æ—¶é—´ç‚¹
- **å…¨å±€æœ‰åº**: ä½¿ç”¨é€»è¾‘æ—¶é’Ÿ(Lamport Timestamp)æˆ–å…±è¯†ç®—æ³•(Raft),è€Œéç‰©ç†æ—¶é—´
- **æ‹œå åº­å®¹é”™**: éœ€è¦ 3f+1 ä¸ªèŠ‚ç‚¹å®¹å¿ f ä¸ªæ¶æ„èŠ‚ç‚¹,æ¶ˆæ¯å¤æ‚åº¦ O(nÂ²),æ€§èƒ½å·®ä½†å®‰å…¨æ€§é«˜

**ä¸ CAP å®šç†çš„è”ç³»**:
- ç½‘ç»œåˆ†åŒº(P)æ˜¯æœ¬ç« çš„æ ¸å¿ƒ
- å½“åˆ†åŒºå‘ç”Ÿæ—¶,å¿…é¡»åœ¨ä¸€è‡´æ€§(C)å’Œå¯ç”¨æ€§(A)ä¹‹é—´é€‰æ‹©
- æ—¶é’Ÿä¸å¯é å¯¼è‡´æ— æ³•ç”¨æ—¶é—´æˆ³å®ç°ä¸€è‡´æ€§

**åœ¨ç³»ç»Ÿè®¾è®¡ä¸­çš„åº”ç”¨**:
- è®¾è®¡åˆ†å¸ƒå¼é”æ—¶,å¿…é¡»ä½¿ç”¨ Fencing Token
- è®¾è®¡åˆ†å¸ƒå¼äº‹åŠ¡æ—¶,ä¸èƒ½ä¾èµ–æ—¶é’Ÿæ’åº
- è®¾è®¡æ•…éšœæ£€æµ‹æ—¶,ä½¿ç”¨è‡ªé€‚åº”è¶…æ—¶å’Œ Quorum

---

### Chapter 9: ä¸€è‡´æ€§ä¸å…±è¯†

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. ä¸€è‡´æ€§ä¿è¯
   - çº¿æ€§ä¸€è‡´æ€§
   - å› æœä¸€è‡´æ€§
   - æœ€ç»ˆä¸€è‡´æ€§
2. é¡ºåºä¿è¯
   - å…¨åºå¹¿æ’­
   - æ—¶é—´æˆ³æ’åº
3. åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†
   - ä¸¤é˜¶æ®µæäº¤ (2PC)
   - å®¹é”™å…±è¯†ç®—æ³• (Paxos, Raft)

**å…³é”®æ¦‚å¿µ**:
- Linearizability
- Total Order Broadcast
- Consensus

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [Paxos Made Simple](https://lamport.azurewebsites.net/pubs/paxos-simple.pdf) - Lamport, 2001
- [In Search of an Understandable Consensus Algorithm (Raft)](https://raft.github.io/raft.pdf) - Ongaro & Ousterhout, 2014

**æ–‡ç« **:
- [Raft Visualization](https://raft.github.io/)
- [Paxos vs Raft](https://www.quora.com/What-is-the-difference-between-Paxos-and-Raft-consensus-algorithms)

---

## ç¬¬ä¸‰éƒ¨åˆ†: æ´¾ç”Ÿæ•°æ®

### Chapter 10: æ‰¹å¤„ç†

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. MapReduce ä¸åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ
2. MapReduce å·¥ä½œæµ
3. è¶…è¶Š MapReduce
   - Spark, Flink

**å…³é”®æ¦‚å¿µ**:
- HDFS, Map, Reduce, Shuffle
- Dataflow Engines

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [MapReduce: Simplified Data Processing](https://static.googleusercontent.com/media/research.google.com/en//archive/mapreduce-osdi04.pdf) - Google, 2004
- [The Google File System](https://static.googleusercontent.com/media/research.google.com/en//archive/gfs-sosp2003.pdf) - Google, 2003

---

### Chapter 11: æµå¤„ç†

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. æ¶ˆæ¯ç³»ç»Ÿ
   - æ¶ˆæ¯ä»£ç† vs æ—¥å¿—
2. æ•°æ®åº“ä¸æµ
   - å˜æ›´æ•°æ®æ•è· (CDC)
   - äº‹ä»¶æº¯æº
3. æµå¤„ç†æ¡†æ¶
   - Kafka Streams, Apache Flink

**å…³é”®æ¦‚å¿µ**:
- Event Sourcing
- CQRS
- Exactly-Once Semantics

#### å»¶ä¼¸èµ„æ–™ (å¾…æ•´ç†)

**è®ºæ–‡**:
- [Kafka: a Distributed Messaging System](https://www.microsoft.com/en-us/research/wp-content/uploads/2017/09/Kafka.pdf)

**æ–‡ç« **:
- [Event Sourcing Pattern](https://martinfowler.com/eaaDev/EventSourcing.html) - Martin Fowler

---

### Chapter 12: æ•°æ®ç³»ç»Ÿçš„æœªæ¥

**é˜…è¯»çŠ¶æ€**: â³ å¾…å­¦ä¹ 

#### é¢„ä¹ å¤§çº²

**æ ¸å¿ƒä¸»é¢˜**:
1. æ•°æ®é›†æˆ
2. è§£è€¦æ‰¹å¤„ç†ä¸æµå¤„ç†
3. æ­£ç¡®æ€§ä¿è¯
4. æ•°æ®éšç§ä¸ä¼¦ç†

---

## ğŸ“– é˜…è¯»è®¡åˆ’

### Week 1-3: åŸºç¡€éƒ¨åˆ†
- [x] Chapter 1: å¯é æ€§ã€å¯æ‰©å±•æ€§ã€å¯ç»´æŠ¤æ€§ âœ… 2025-10-16
- [ ] Chapter 2: æ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€ (è®¡åˆ’: Week 2)
- [ ] Chapter 3: å­˜å‚¨ä¸æ£€ç´¢ (è®¡åˆ’: Week 2)
- [ ] Chapter 4: ç¼–ç ä¸æ¼”åŒ– (è®¡åˆ’: Week 3)

### Week 4-6: åˆ†å¸ƒå¼æ•°æ®
- [ ] Chapter 5: å¤åˆ¶ (è®¡åˆ’: Week 2-3)
- [ ] Chapter 6: åˆ†åŒº (è®¡åˆ’: Week 2)
- [ ] Chapter 7: äº‹åŠ¡ (è®¡åˆ’: Week 2)
- [ ] Chapter 8: åˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦ (è®¡åˆ’: Week 8)
- [ ] Chapter 9: ä¸€è‡´æ€§ä¸å…±è¯† (è®¡åˆ’: Week 8)

### Week 7-8: æ´¾ç”Ÿæ•°æ®
- [ ] Chapter 10: æ‰¹å¤„ç† (å¯é€‰)
- [ ] Chapter 11: æµå¤„ç† (è®¡åˆ’: Week 6)
- [ ] Chapter 12: æ•°æ®ç³»ç»Ÿçš„æœªæ¥ (å¯é€‰)

---

## ğŸ’¡ å­¦ä¹ æ–¹æ³•

### é˜…è¯»ç­–ç•¥

1. **é¦–æ¬¡é˜…è¯»**: å¿«é€Ÿæµè§ˆ,ç†è§£ç« èŠ‚ç»“æ„
2. **æ·±å…¥é˜…è¯»**: ä»”ç»†é˜…è¯»,åšæ ‡æ³¨å’Œç¬”è®°
3. **å®è·µéªŒè¯**: é€šè¿‡ä»£ç æˆ–å®éªŒéªŒè¯æ¦‚å¿µ
4. **æ€»ç»“è¾“å‡º**: ç”¨è‡ªå·±çš„è¯æ€»ç»“æ ¸å¿ƒè¦ç‚¹

### ç¬”è®°æ¨¡æ¿

æ¯ç« å®Œæˆå,è®°å½•:
- âœ… **æ ¸å¿ƒæ¦‚å¿µ**: 3-5 ä¸ªå…³é”®æ¦‚å¿µ
- âœ… **ç»å…¸æ¡ˆä¾‹**: ä¹¦ä¸­çš„çœŸå®ç³»ç»Ÿæ¡ˆä¾‹
- âœ… **å…³é”®æ´å¯Ÿ**: æœ€é‡è¦çš„ takeaway
- âœ… **å»¶ä¼¸é˜…è¯»**: è®ºæ–‡ã€æ–‡ç« ã€è§†é¢‘é“¾æ¥
- âœ… **å®è·µç»ƒä¹ **: åŠ¨æ‰‹éªŒè¯çš„å®éªŒæˆ–ä»£ç 
- âœ… **æˆ‘çš„æ€è€ƒ**: é—®é¢˜å’Œæ€è€ƒ

### ä¸è¯¾ç¨‹ç»“åˆ

**DDIA ç« èŠ‚å¯¹åº”è¯¾ç¨‹æ¨¡å—**:

| DDIA ç« èŠ‚ | è¯¾ç¨‹æ¨¡å— |
|----------|---------|
| Chapter 1 | Week 1 - å¯æ‰©å±•æ€§åŸºç¡€ |
| Chapter 3 | Week 2 - å­˜å‚¨ç³»ç»ŸåŸç† |
| Chapter 5 | Week 2 - åˆ†å¸ƒå¼å­˜å‚¨ä¸ä¸€è‡´æ€§ |
| Chapter 6 | Week 2 - æ•°æ®åˆ†ç‰‡, Week 5 - æ•°æ®åº“åˆ†ç‰‡ |
| Chapter 7 | Week 2 - ACID å®ç°, Week 5 - åˆ†å¸ƒå¼äº‹åŠ¡ |
| Chapter 9 | Week 8 - ä¸€è‡´æ€§ç®—æ³• |
| Chapter 11 | Week 3 - æ¶ˆæ¯é˜Ÿåˆ—, Week 6 - äº‹ä»¶é©±åŠ¨ |

---

## ğŸ”— å…¨ä¹¦ç›¸å…³èµ„æº

### å®˜æ–¹èµ„æº

- [DDIA å®˜ç½‘](https://dataintensive.net/)
- [ä½œè€… Martin Kleppmann åšå®¢](https://martin.kleppmann.com/)
- [å‹˜è¯¯è¡¨](https://github.com/ept/ddia-references)

### é…å¥—è¯¾ç¨‹

- [Martin Kleppmann's Distributed Systems Lecture](https://www.youtube.com/playlist?list=PLeKd45zvjcDFUEv_ohr_HdUFe97RItdiB)
- [MIT 6.824: Distributed Systems](https://pdos.csail.mit.edu/6.824/)

### ä¸­æ–‡èµ„æº

- ä¸­æ–‡ç¿»è¯‘ç‰ˆ: ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹
- [ddia-cn (ä¸­æ–‡ç‰ˆåœ¨çº¿é˜…è¯»)](https://github.com/Vonng/ddia)

### è®¨è®ºç¤¾åŒº

- [r/ddia on Reddit](https://www.reddit.com/r/ddia/)
- [DDIA Book Club](https://github.com/ept/ddia-references/issues)

---

## ğŸ“Š é˜…è¯»è¿›åº¦ç»Ÿè®¡

**æ€»è¿›åº¦**: 1/12 ç« èŠ‚ (8.3%)

**Part I**: 1/4 ç« èŠ‚å®Œæˆ
**Part II**: 0/5 ç« èŠ‚å®Œæˆ
**Part III**: 0/3 ç« èŠ‚å®Œæˆ

**æ€»å­¦ä¹ æ—¶é•¿**: _____ å°æ—¶
**ç¬”è®°æ€»å­—æ•°**: _____ å­—

---

## ğŸ’­ æ•´ä½“æ€è€ƒ

### ä¸ºä»€ä¹ˆè¯» DDIA?

1. **ç³»ç»Ÿè®¾è®¡çš„ç†è®ºåŸºç¡€**: ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µ
2. **å·¥ç¨‹å®è·µçš„æŒ‡å¯¼**: çœŸå®æ¡ˆä¾‹å’Œæƒè¡¡åˆ†æ
3. **é¢è¯•å‡†å¤‡**: ç³»ç»Ÿè®¾è®¡é¢è¯•çš„å¿…å¤‡çŸ¥è¯†
4. **æŠ€æœ¯é€‰å‹**: ä¸ºé¡¹ç›®é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ ˆ

### æœ€å¤§æ”¶è· (æŒç»­æ›´æ–°)

1. **Twitter æ‰‡å‡ºæ¡ˆä¾‹**: ç†è§£äº†è¯»å†™æƒè¡¡çš„æœ¬è´¨
2. **P99 å»¶è¿Ÿçš„é‡è¦æ€§**: æ€§èƒ½æŒ‡æ ‡åº”è¯¥å…³æ³¨é•¿å°¾
3. **æ²¡æœ‰é“¶å¼¹**: ç³»ç»Ÿè®¾è®¡å–å†³äºè´Ÿè½½ç‰¹å¾

### å¾…æ·±å…¥çš„ä¸»é¢˜

- [ ] CAP å®šç†ä¸ PACELC çš„å…³ç³»
- [ ] åˆ†å¸ƒå¼äº‹åŠ¡çš„å„ç§å®ç°æ–¹æ¡ˆå¯¹æ¯”
- [ ] ä¸€è‡´æ€§æ¨¡å‹çš„è°±ç³»
- [ ] æµå¤„ç†ä¸æ‰¹å¤„ç†çš„ç»Ÿä¸€

---

**æ›´æ–°æ—¥æœŸ**: 2025-10-16
**ä¸‹æ¬¡æ›´æ–°**: å¼€å§‹ Chapter 2 æ—¶æ›´æ–°
